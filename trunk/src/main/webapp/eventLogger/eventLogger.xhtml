<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pm="http://primefaces.org/mobile">

    <f:view renderKitId="PRIMEFACES_MOBILE" />

    <h:head></h:head>

    <h:body>

        <pm:page id="firstScreen">
            <p:dialog header="About CT" widgetVar="dialogInfo" showEffect="pop">
                <h:outputText value="Cargo Tracker is ... and this is some information that still need to be filled.&lt;br/&gt;For more, please visit..." escape = "false"/>
            </p:dialog>

            <pm:header title="Event Logger" fixed="true" swatch="b">
                <f:facet name="left">
                    <p:button value="Quit" onclick="window.close()"/>
                </f:facet>
                <f:facet name="right">
                    <p:button value="Next" outcome="pm:secondScreen?transition=flip"/>
                </f:facet>
            </pm:header>

            <!--p:commandButton  value="About" onclick="PF('dialogInfo').show();" /-->

            <pm:content>
                <h:form id="firstForm">
                    <h:panelGrid columns="1" style="width: 100%;" >    
                        <p:selectOneMenu id="trackingId" value="#{eventBackingBean.trackId}"
                                         required="true" requiredMessage="Tracking missing">
                            <p:ajax listener="#{eventBackingBean.updateVoyage}" update="panelVoyage"/>
                            <f:selectItem itemLabel="Tracking" itemValue="#{eventBackingBean.trackId}" />
                            <f:selectItems value="#{eventBackingBean.trackIds}" /> 
                        </p:selectOneMenu>

                        <h:selectOneMenu id="portCode" value="#{eventBackingBean.location}"
                                         requiredMessage="Location missing" required="true">
                            <p:ajax listener="#{eventBackingBean.updateListener}"/>
                            <f:selectItem itemLabel="Port" itemValue="#{eventBackingBean.location}" />
                            <f:selectItems value="#{eventBackingBean.locations}" />
                        </h:selectOneMenu>

                        <p:outputPanel id="panelVoyage">
                            <p:selectOneMenu id="voyage" value="#{eventBackingBean.voyageNumber}"
                                             disabled="#{not eventBackingBean.voyageSelectable}" 
                                             required="true" requiredMessage="Voyage missing">
                                <p:ajax listener="#{eventBackingBean.updateListener}"/>
                                <f:selectItem itemLabel="Voyage" itemValue="#{eventBackingBean.voyageNumber}" />
                                <f:selectItems value="#{eventBackingBean.voyages}" />
                            </p:selectOneMenu>
                        </p:outputPanel>

                        <p:selectOneMenu id="eventType" value="#{eventBackingBean.eventType}" 
                                         requiredMessage="Event missing" required="true">
                            <p:ajax listener="#{eventBackingBean.updateListener}"/>
                            <f:selectItem itemLabel="Event" itemValue="" noSelectionOption="true" />
                            <f:selectItem itemLabel="LOAD" itemValue="LOAD" />
                            <f:selectItem itemLabel="UNLOAD" itemValue="UNLOAD" />
                            <f:selectItem itemLabel="RECEIVE" itemValue="RECEIVE" />
                            <f:selectItem itemLabel="CLAIM" itemValue="CLAIM" />
                            <f:selectItem itemLabel="CUSTOMS" itemValue="CUSTOMS" />
                        </p:selectOneMenu>
                    </h:panelGrid>
                </h:form>

                <p:separator />

                <center><h:graphicImage value="/images/CTlogobadge128.png" height="48"/></center>
            </pm:content>
        </pm:page>


        <pm:page id="secondScreen">

            <pm:header id="header" title="Event Logger" fixed="true" swatch="b">
                <f:facet name="left">
                    <p:button value="Back" outcome="pm:firstScreen?transition=flip" />
                </f:facet>
                <f:facet id="right" name="right">
                    <h:form>
                        <p:commandButton  id="subBtn" value="Submit" actionListener="#{eventBackingBean.handleEventSubmission}" 
                                          ajax="false" disabled="#{!eventBackingBean.eventSubmitable}"/>
                    </h:form>
                </f:facet>
            </pm:header>

            <!--p:commandButton value="Submit" actionListener="#  {eventBackingBean.handleEventSubmission}" ajax="false" disabled="#  {!eventBackingBean.eventSubmitable}"/-->
            <!-- p:commandButton value="Restart" actionListener="#  {eventBackingBean.restart}" action="pm:firstScreen?transition=flip" ajax="false"/-->        
            <pm:content>
                <h:form>
                    <p:growl id="msgs" showDetail="false" />

                    <h:panelGrid columns="2" style="width: 100%" columnClasses="forty-percent, sixty-percent">
                        <p:outputLabel value="Time" for="completionTime"/>
                        <p:calendar id="completionTime" value="#{eventBackingBean.completionTime}" 
                                    requiredMessage="A date is needed" required="false"
                                    pattern="MM/dd/yyyy" >
                            <p:ajax event="dateSelect" listener="#{eventBackingBean.timeSet()}" update=":#{p:component('subBtn')}"/>
                        </p:calendar>
                    </h:panelGrid>

                </h:form>
                <p:separator />
                <center><h:graphicImage value="/images/CTlogobadge128.png" height="48"/></center>
            </pm:content>
        </pm:page>

    </h:body>
</html>